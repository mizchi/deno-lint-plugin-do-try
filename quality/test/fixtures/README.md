# コード品質計算モジュール（v3）テスト用サンプルコード

このディレクトリには、コード品質計算モジュール（v3）をテストするための様々な複雑さレベルのコードサンプルが含まれています。これらのサンプルは、モジュールが検出する様々な複雑度指標をテストするために設計されています。

## サンプルコードの概要

### simple.ts

シンプルなコード（低複雑度）のサンプルです。以下の特徴があります：

- 単純な関数（`add`、`average`、`calculateDistance`など）
- 基本的な型定義（`Point`型）
- シンプルなオブジェクト操作（`createUser`関数）
- 単純なループ処理（`sum`関数）
- 単純な文字列操作（`reverseString`関数）

このサンプルは、以下の複雑度指標をテストします：

- 低い関数の複雑さ
- 最小限の変数の変更可能性
- 単純なスコープ構造
- 最小限の代入操作
- 例外処理なし

### medium.ts

中程度の複雑さを持つコードのサンプルです。以下の特徴があります：

- クラス定義と継承（`Calculator`と`HistoryCalculator`）
- 複数の関数と相互作用
- 条件分岐とループ
- エラーハンドリング（try-catch ブロック）
- メソッドのオーバーライド

このサンプルは、以下の複雑度指標をテストします：

- 中程度の関数の複雑さ
- 変数の変更可能性（let 変数の使用）
- 中程度のスコープの複雑さ
- 複数の代入操作
- 基本的な条件分岐の複雑さ
- 基本的な例外処理

### complex.ts

非常に複雑なコードのサンプルです。以下の特徴があります：

- 複雑なクラス階層（抽象クラス、インターフェース、実装クラス）
- 多数の関数と複雑な相互作用
- 深いネストの条件分岐
- 複雑なエラーハンドリング
- 状態管理（キャッシュなど）
- 非同期処理
- 複雑なデータ変換

このサンプルは、以下の複雑度指標をテストします：

- 高い関数の複雑さ
- 高い変数の変更可能性
- 複雑なスコープ構造
- 多数の代入操作
- 深いネストの条件分岐
- 複雑な例外処理

### compact_complex.ts

約 100 行程度の端的に複雑なコードサンプルです。以下の特徴があります：

- ネストされた条件分岐（3 段階以上の if 文、複雑な条件式、switch 文）
- 複数の try-catch ブロックとネストされた try-catch
- 関数の相互呼び出し（相互呼び出し、再帰関数、コールバック関数、高階関数）
- カスタムエラークラスの定義と使用
- 非同期処理（async/await）
- 複雑なデータ構造の操作
- 状態の変更（let の使用）

このサンプルは、以下の複雑度指標をテストします：

- 高い関数の複雑さ（ただし、compact_complex は complex.ts よりもコンパクト）
- 中程度の変数の変更可能性
- 複雑なスコープ構造
- 複数の代入操作
- 深いネストの条件分岐
- 複雑な例外処理
- do プレフィックスを持つ関数の呼び出しパターン

## コード品質指標のテスト方法

これらのサンプルコードは、v3 モジュールの以下の機能をテストするために設計されています：

1. **変数の変更可能性の検出**：特に`let`で宣言された変数の変更回数を追跡します。
2. **スコープの複雑さの測定**：スコープ内のシンボル数に基づいて複雑さを計算します。
3. **関数の複雑さの評価**：引数の数、本体の複雑さ、推定呼び出し回数に基づいて関数の複雑さを評価します。
4. **条件分岐の複雑さの分析**：if 文、switch 文、三項演算子などの条件分岐の複雑さを分析します。
5. **例外処理の複雑さの評価**：try-catch-finally ブロックや throw 文の複雑さを評価します。

## 使用方法

`fixtures_test.ts`ファイルを使用して、各サンプルコードの複雑度を分析し、結果を表示できます。このテストファイルは、v3 モジュールの主要な機能（`analyzeCodeComplexity`、`calculateComplexityScore`、`compareCodeComplexity`、`generateDetailedComplexityReport`）を使用して、サンプルコードの複雑度を評価します。

```bash
deno test quality/fixtures_test.ts
```

このテストを実行することで、各サンプルコードの複雑度指標と、それらの比較結果を確認できます。
